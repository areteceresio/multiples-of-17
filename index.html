<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Fullscreen Multiples of 17</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    background: #111;
    color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    overflow: hidden;
    touch-action: manipulation;
  }

  /* Number fills most of the screen */
  #number {
    font-size: calc(10vw + 10vh); /* scales with both width and height */
    max-height: 100%;
    white-space: nowrap;
    text-align: center;
    user-select: none;
  }

  /* Buttons tucked into top-left corner, very small */
  .controls {
    position: fixed;
    top: env(safe-area-inset-top, 10px);
    left: env(safe-area-inset-left, 10px);
    display: flex;
    gap: 6px;
    z-index: 1000;
  }

  .controls button {
    font-size: 12px;
    padding: 4px 8px;
    border-radius: 6px;
    border: none;
    background: #00c853;
    color: black;
  }

  .controls button.stop {
    background: #ff5252;
  }

  /* Fullscreen for PWA / Add to Home Screen */
  @media (display-mode: standalone) {
    body {
      width: 100vw;
      height: 100vh;
    }
  }

  @media (orientation: portrait) {
    #number {
      font-size: calc(12vw + 12vh); /* slightly bigger in portrait */
    }
  }
</style>
</head>
<body>

<div id="number">—</div>

<div class="controls">
  <button onclick="start()">▶</button>
  <button class="stop" onclick="stop()">⏹</button>
</div>

<script>
let audioKeepAlive;
let running = false;

function randomMultipleOf17() {
  const max = Math.floor(1700000 / 17);
  return (Math.floor(Math.random() * max) + 1) * 17;
}

function speakAndScheduleNext() {
  if (!running) return;

  const num = randomMultipleOf17();
  document.getElementById("number").textContent = num;

  const utterance = new SpeechSynthesisUtterance(num.toString());
  utterance.rate = 0.9;

  utterance.onend = () => {
    if (!running) return;
    setTimeout(speakAndScheduleNext, 5000);
  };

  speechSynthesis.speak(utterance);
}

function start() {
  if (running) return;
  running = true;

  // Tiny silent audio to keep iOS awake
  audioKeepAlive = new Audio("https://upload.wikimedia.org/wikipedia/commons/8/8c/Silence_1s.mp3");
  audioKeepAlive.loop = true;
  audioKeepAlive.volume = 0.01;
  audioKeepAlive.play();

  speakAndScheduleNext();
}

function stop() {
  running = false;
  speechSynthesis.cancel();

  if (audioKeepAlive) {
    audioKeepAlive.pause();
    audioKeepAlive = null;
  }

  document.getElementById("number").textContent = "—";
}
</script>

</body>
</html>
